<!DOCTYPE HTML>
<html>
<head>
  <title>Inner frame performing a basic sendBeacon from within an iframe</title>
  <script src="/tests/SimpleTest/SimpleTest.js"></script>
</head>
<body>
<script type="text/javascript">

function sendBeacon() {
    var frame = window.parent.document.getElementById("frame");
    // using data as id because it's unique-ish
    var id = frame.getAttribute("data");
    var data = window.parent.beaconConvert(frame.getAttribute("data"));
    var beaconUri = "http://mochi.test:8888/tests/dom/tests/mochitest/beacon/beacon-handler.sjs?beaconid=" + id;
    var result = navigator.sendBeacon(beaconUri, data);
    window.parent.beaconSent(result);
}

window.addEventListener("load", function() { setTimeout(sendBeacon, 0); });

</script>
</body>
</html>

